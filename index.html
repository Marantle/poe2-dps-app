<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Path of Exile 2 DPS Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f4;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        textarea {
            width: 100%;
            height: 200px;
            margin-bottom: 10px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        #results {
            margin-top: 20px;
        }
        .damage-type {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Path of Exile 2 DPS Calculator</h1>
        <textarea id="itemInput" placeholder="Paste your item details here..."></textarea>
        <button id="calculateButton">Calculate DPS</button>
        <div id="results"></div>
    </div>

    <script>
        function extractDamageRange(input, damageType) {
            const regex = new RegExp(`${damageType}:\\s*(\\d+)-(\\d+)`, 'i');
            const match = input.match(regex);
            if (match) {
                const min = parseInt(match[1]);
                const max = parseInt(match[2]);
                return { min, max };
            }
            return { min: 0, max: 0 };
        }

        function extractElementalDamage(input) {
            const regex = /Elemental Damage: (.+)/;
            const match = input.match(regex);
            if (match) {
                const damages = match[1].split(', ');
                return damages.map(damage => {
                    const [min, max] = damage.match(/(\d+)-(\d+)/).slice(1, 3).map(Number);
                    return { min, max };
                });
            }
            return [];
        }

        function extractAttacksPerSecond(input) {
            const match = input.match(/Attacks per Second:\s*([\d.]+)/);
            return match ? parseFloat(match[1]) : 1;
        }

        function calculateDPSForType(damageRange, attacksPerSecond) {
            const averageDamage = (damageRange.min + damageRange.max) / 2;
            return averageDamage * attacksPerSecond;
        }

        function calculateDPS() {
            const input = document.getElementById('itemInput').value;
            const results = document.getElementById('results');
            
            // Extract damage ranges and attack speed
            const physicalDamage = extractDamageRange(input, 'Physical Damage');
            const elementalDamages = extractElementalDamage(input);
            const attacksPerSecond = extractAttacksPerSecond(input);

            // Calculate DPS for each damage type
            const physicalDPS = calculateDPSForType(physicalDamage, attacksPerSecond);
            const elementalDPSs = elementalDamages.map(damage => calculateDPSForType(damage, attacksPerSecond));

            // Calculate combined elemental DPS
            const elementalDPS = elementalDPSs.reduce((sum, dps) => sum + dps, 0);

            // Prepare results HTML
            let resultsHTML = '<h2>DPS Calculations:</h2>';
            if (physicalDPS > 0) resultsHTML += `<p><span class="damage-type">Physical DPS:</span> ${physicalDPS.toFixed(2)}</p>`;
            
            const damageTypes = ['Fire', 'Cold', 'Lightning'];
            elementalDPSs.forEach((dps, index) => {
                if (dps > 0) resultsHTML += `<p><span class="damage-type">${damageTypes[index]} DPS:</span> ${dps.toFixed(2)}</p>`;
            });
            
            if (elementalDPS > 0) resultsHTML += `<p><span class="damage-type">Combined Elemental DPS:</span> ${elementalDPS.toFixed(2)}</p>`;
            
            const totalDPS = physicalDPS + elementalDPS;
            resultsHTML += `<p><span class="damage-type">Total DPS:</span> ${totalDPS.toFixed(2)}</p>`;
            
            // Display results
            results.innerHTML = resultsHTML;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const calculateButton = document.getElementById('calculateButton');
            calculateButton.addEventListener('click', calculateDPS);
        });
    </script>
</body>
</html>
